<!-- equipmentSelection/templates/equipmentSelection/calculate_signals.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Calculate Signals</title>
{#    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>#}
</head>
<body>
    <h1>Equipment Selection</h1>

{#    <form method="post" action="{% url 'calculate_signals' %}" id="calculation-form">#}
{#        {% csrf_token %}#}
{##}
{#        <table>#}
{#            <thead>#}
{#                <tr>#}
{#                    <th>Equipment</th>#}
{#                    <th>Count</th>#}
{#                </tr>#}
{#            </thead>#}
{#            <tbody>#}
{#                {% for equipment in equipments %}#}
{#                <tr>#}
{#                    <td>{{ equipment.name }}</td>#}
{#                    <td>#}
{#                        <input type="number" name="count_{{ equipment.id }}" value="0" min="0">#}
{#                    </td>#}
{#                </tr>#}
{#                {% endfor %}#}
{#            </tbody>#}
{#        </table>#}
{##}
{#        <button type="button" id="calculate-button">Calculate</button>#}
{#    </form>#}

{#    <h2>Total Signals:</h2>#}
{#    <ul id="total-signals-list">#}
{#        {% for equipment in equipments %}#}
{#        <li id="total-signals-{{ equipment.id }}">{{ equipment.name }}: 0</li>#}
{#        {% endfor %}#}
{#    </ul>#}

{#    <h2>Total Overall Signals: <span id="total-overall-signals">0</span></h2>#}

{#    <script>#}
{#        $(document).ready(function () {#}
{#            $("#calculate-button").click(function () {#}
{#                $.ajax({#}
{#                    type: "POST",#}
{#                    url: $("#calculation-form").attr("action"),#}
{#                    data: $("#calculation-form").serialize(),#}
{#                    success: function (data) {#}
{#                        updateTotalSignals(data);#}
{#                    }#}
{#                });#}
{#            });#}
{##}
{#            function updateTotalSignals(data) {#}
{#                var totalOverallSignals = 0;#}
{#                var signalsByType = data.total_signals_by_type;#}
{##}
{#                for (var key in signalsByType) {#}
{#                    var equipmentId = key.split('_')[1];#}
{#                    var totalSignals = signalsByType[key];#}
{#                    $("#total-signals-" + equipmentId).text("Total Signals: " + totalSignals);#}
{#                    totalOverallSignals += totalSignals;#}
{#                }#}
{##}
{#                $("#total-overall-signals").text(totalOverallSignals);#}
{#            }#}
{#        });#}
{#    </script>#}
</body>
</html>